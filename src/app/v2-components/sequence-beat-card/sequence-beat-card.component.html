
<div [class.needs-assignment]="!beatSequenceId" [class.has-assignment]="!!beatSequenceId" style="padding: 0.5em; margin-bottom: 0.5em;">
    <h4>{{getTemplateOneLiner()}} ({{getDurationString()}})</h4>
    <p>{{getTemplateDescription()}}</p>
    <div *ngIf="!!beatSequenceId">
        <div style="display: flex;">
            <mat-form-field style="flex: 1">
                <textarea matInput placeholder="One-Line Beat Summary"
                    cdkTextareaAutosize
                    cdkAutosizeMinRows="1"
                    cdkAutosizeMaxRows="5"
                    [value]="getBeatOneliner()"
                    (input)="oneLinerInput($event)"
                ></textarea>
            </mat-form-field>
            <button mat-button style="flex:0;" (click)="detach()">
                <mat-icon>link_off</mat-icon>
            </button>
        </div>
    </div>
    <div *ngIf="!beatSequenceId">
        <div style="display: flex;">
            <button mat-button style="flex:0;" (click)="addNew()" title="Add New">
                <mat-icon>create</mat-icon>
            </button>
            <span style="flex:1;">&nbsp;</span>
            <button mat-button style="flex:0;" (click)="showHideUnassignedTable()" [disabled]="!getAnyUnassigned()" title="Link to Existing">
                <mat-icon *ngIf="!showUnassignedTable">arrow_drop_down</mat-icon>
                <mat-icon *ngIf="!!showUnassignedTable">arrow_drop_up</mat-icon>
            </button>
        </div>
        <table *ngIf="!!showUnassignedTable" mat-table [dataSource]="unassignedOptionDataSource" style="width: 100%;">
        
            <!-- Oneliner Column -->
            <ng-container matColumnDef="oneLiner">
                <th mat-header-cell *matHeaderCellDef> One-Liner </th>
                <td mat-cell *matCellDef="let option"> {{option.oneLiner}} </td>
            </ng-container>

            <!-- Oneliner Column -->
            <ng-container matColumnDef="durationMinStr">
                <th mat-header-cell *matHeaderCellDef> Duration </th>
                <td mat-cell *matCellDef="let option"> {{option.durationMinStr}} </td>
            </ng-container>

            <!-- Id Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> </th>
                <td mat-cell *matCellDef="let option"> <button mat-button (click)="handleAssignment(option.id)"><mat-icon>link</mat-icon></button> </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="unassignedOptionColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: unassignedOptionColumns;"></tr>
        </table>
    </div>
</div>
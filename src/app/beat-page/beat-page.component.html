<div class="content-wrapper">
  <div class="story-nav">
    <h3>All Stories</h3>
    <app-beat-nav
      [selectedBeatId]="selectedBeatId"
      [beatListView]="beatListView"
      (newBeat)="newBeat()"
      (selectBeat)="selectBeat($event)"
      (deleteBeat)="deleteBeat()"></app-beat-nav>
  </div>

  <div class="story-prose">
    <div class="button-row">
      <span class="spacer">&nbsp;</span>
      <span *ngIf="parentListView.length > 0">
        Parent Beat(s):
      </span>
      <button
        *ngFor="let parentBeat of parentListView"
        mat-stroked-button
        (click)="selectParentBeat(parentBeat.id)"
        >
        {{parentBeat.name}}
      </button>
    </div>
    <app-beat-prose-edit
      [beat]="selectedBeat"
      [childSumDuration]="getChildSumDuration()"
      (onBeatUpdated)="onBeatUpdated($event)"></app-beat-prose-edit>
  </div>

  <ng-container *ngIf="!!selectedBeat">
    <mat-tab-group
      animationDuration="0ms"
      [selectedIndex]="selectedTabIndex"
      (selectedIndexChange)="tabChange($event)">
      <mat-tab label="Structure / Brainstorm">
        <app-beat-related-beat-nav
          class="beat-nav"
          [selectedBeatId]="selectedChildBeatId"
          [brainstormListView]="brainstormListView"
          [structureListView]="structureListView"
          (newBeat)="newChildBeat($event)"
          (selectBeat)="selectChildBeat($event)"
          (moveBeat)="moveChildBeat($event)"
          (deleteBeat)="deleteChildBeat()"></app-beat-related-beat-nav>
      </mat-tab>
      <mat-tab label="New Structure">
        <app-apply-structure-nav
          [selectedTemplateId]="selectedTemplateUuid"
          [structureTemplateListView]="structureTemplateListView"
          [rescaledSelectedTemplate]="rescaledStructureTemplate"
          (selectTemplate)="selectStructureTemplate($event)"
          (applyTemplate)="applyStructureTemplate()"
        ></app-apply-structure-nav>
      </mat-tab>
    </mat-tab-group>

    <div
      *ngIf="!!selectedChildBeatId"
      class="story-prose">
      <div class="button-row">
        <span class="spacer">&nbsp;</span>
        <button
          mat-stroked-button
          (click)="selectBeat(selectedChildBeatId)"
        >Edit</button>
      </div>
      <app-beat-prose-edit
        [beat]="selectedChildBeat"
        (onBeatUpdated)="onBeatUpdated($event)"></app-beat-prose-edit>
    </div>
  </ng-container>

</div>

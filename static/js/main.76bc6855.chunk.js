(this.webpackJsonprevision=this.webpackJsonprevision||[]).push([[0],{14:function(t,e,r){var n,i,s;i=[r(255)],void 0===(s="function"===typeof(n=function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,i=t.roots.default||(t.roots.default={});return i.Timestamp=function(){function s(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return s.prototype.seconds=0,s.prototype.nanos=0,s.create=function(t){return new s(t)},s.encode=function(t,e){return e||(e=r.create()),null!=t.seconds&&Object.hasOwnProperty.call(t,"seconds")&&e.uint32(8).int32(t.seconds),null!=t.nanos&&Object.hasOwnProperty.call(t,"nanos")&&e.uint32(16).int32(t.nanos),e},s.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},s.decode=function(t,r){t instanceof e||(t=e.create(t));for(var n=void 0===r?t.len:t.pos+r,s=new i.Timestamp;t.pos<n;){var a=t.uint32();switch(a>>>3){case 1:s.seconds=t.int32();break;case 2:s.nanos=t.int32();break;default:t.skipType(7&a)}}return s},s.decodeDelimited=function(t){return t instanceof e||(t=new e(t)),this.decode(t,t.uint32())},s.verify=function(t){return"object"!==typeof t||null===t?"object expected":null!=t.seconds&&t.hasOwnProperty("seconds")&&!n.isInteger(t.seconds)?"seconds: integer expected":null!=t.nanos&&t.hasOwnProperty("nanos")&&!n.isInteger(t.nanos)?"nanos: integer expected":null},s.fromObject=function(t){if(t instanceof i.Timestamp)return t;var e=new i.Timestamp;return null!=t.seconds&&(e.seconds=0|t.seconds),null!=t.nanos&&(e.nanos=0|t.nanos),e},s.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.seconds=0,r.nanos=0),null!=t.seconds&&t.hasOwnProperty("seconds")&&(r.seconds=t.seconds),null!=t.nanos&&t.hasOwnProperty("nanos")&&(r.nanos=t.nanos),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s}(),i.Duration=function(){function s(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return s.prototype.seconds=0,s.prototype.nanos=0,s.create=function(t){return new s(t)},s.encode=function(t,e){return e||(e=r.create()),null!=t.seconds&&Object.hasOwnProperty.call(t,"seconds")&&e.uint32(8).int32(t.seconds),null!=t.nanos&&Object.hasOwnProperty.call(t,"nanos")&&e.uint32(16).int32(t.nanos),e},s.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},s.decode=function(t,r){t instanceof e||(t=e.create(t));for(var n=void 0===r?t.len:t.pos+r,s=new i.Duration;t.pos<n;){var a=t.uint32();switch(a>>>3){case 1:s.seconds=t.int32();break;case 2:s.nanos=t.int32();break;default:t.skipType(7&a)}}return s},s.decodeDelimited=function(t){return t instanceof e||(t=new e(t)),this.decode(t,t.uint32())},s.verify=function(t){return"object"!==typeof t||null===t?"object expected":null!=t.seconds&&t.hasOwnProperty("seconds")&&!n.isInteger(t.seconds)?"seconds: integer expected":null!=t.nanos&&t.hasOwnProperty("nanos")&&!n.isInteger(t.nanos)?"nanos: integer expected":null},s.fromObject=function(t){if(t instanceof i.Duration)return t;var e=new i.Duration;return null!=t.seconds&&(e.seconds=0|t.seconds),null!=t.nanos&&(e.nanos=0|t.nanos),e},s.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.seconds=0,r.nanos=0),null!=t.seconds&&t.hasOwnProperty("seconds")&&(r.seconds=t.seconds),null!=t.nanos&&t.hasOwnProperty("nanos")&&(r.nanos=t.nanos),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s}(),i.Story=function(){function s(t){if(this.relatedStoryIds=[],t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return s.prototype.id="",s.prototype.name="",s.prototype.description="",s.prototype.duration=null,s.prototype.relatedStoryIds=n.emptyArray,s.create=function(t){return new s(t)},s.encode=function(t,e){if(e||(e=r.create()),null!=t.id&&Object.hasOwnProperty.call(t,"id")&&e.uint32(10).string(t.id),null!=t.name&&Object.hasOwnProperty.call(t,"name")&&e.uint32(18).string(t.name),null!=t.duration&&Object.hasOwnProperty.call(t,"duration")&&i.Duration.encode(t.duration,e.uint32(26).fork()).ldelim(),null!=t.relatedStoryIds&&t.relatedStoryIds.length)for(var n=0;n<t.relatedStoryIds.length;++n)e.uint32(34).string(t.relatedStoryIds[n]);return null!=t.description&&Object.hasOwnProperty.call(t,"description")&&e.uint32(42).string(t.description),e},s.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},s.decode=function(t,r){t instanceof e||(t=e.create(t));for(var n=void 0===r?t.len:t.pos+r,s=new i.Story;t.pos<n;){var a=t.uint32();switch(a>>>3){case 1:s.id=t.string();break;case 2:s.name=t.string();break;case 5:s.description=t.string();break;case 3:s.duration=i.Duration.decode(t,t.uint32());break;case 4:s.relatedStoryIds&&s.relatedStoryIds.length||(s.relatedStoryIds=[]),s.relatedStoryIds.push(t.string());break;default:t.skipType(7&a)}}return s},s.decodeDelimited=function(t){return t instanceof e||(t=new e(t)),this.decode(t,t.uint32())},s.verify=function(t){if("object"!==typeof t||null===t)return"object expected";if(null!=t.id&&t.hasOwnProperty("id")&&!n.isString(t.id))return"id: string expected";if(null!=t.name&&t.hasOwnProperty("name")&&!n.isString(t.name))return"name: string expected";if(null!=t.description&&t.hasOwnProperty("description")&&!n.isString(t.description))return"description: string expected";if(null!=t.duration&&t.hasOwnProperty("duration")){var e=i.Duration.verify(t.duration);if(e)return"duration."+e}if(null!=t.relatedStoryIds&&t.hasOwnProperty("relatedStoryIds")){if(!Array.isArray(t.relatedStoryIds))return"relatedStoryIds: array expected";for(var r=0;r<t.relatedStoryIds.length;++r)if(!n.isString(t.relatedStoryIds[r]))return"relatedStoryIds: string[] expected"}return null},s.fromObject=function(t){if(t instanceof i.Story)return t;var e=new i.Story;if(null!=t.id&&(e.id=String(t.id)),null!=t.name&&(e.name=String(t.name)),null!=t.description&&(e.description=String(t.description)),null!=t.duration){if("object"!==typeof t.duration)throw TypeError(".Story.duration: object expected");e.duration=i.Duration.fromObject(t.duration)}if(t.relatedStoryIds){if(!Array.isArray(t.relatedStoryIds))throw TypeError(".Story.relatedStoryIds: array expected");e.relatedStoryIds=[];for(var r=0;r<t.relatedStoryIds.length;++r)e.relatedStoryIds[r]=String(t.relatedStoryIds[r])}return e},s.toObject=function(t,e){e||(e={});var r={};if((e.arrays||e.defaults)&&(r.relatedStoryIds=[]),e.defaults&&(r.id="",r.name="",r.duration=null,r.description=""),null!=t.id&&t.hasOwnProperty("id")&&(r.id=t.id),null!=t.name&&t.hasOwnProperty("name")&&(r.name=t.name),null!=t.duration&&t.hasOwnProperty("duration")&&(r.duration=i.Duration.toObject(t.duration,e)),t.relatedStoryIds&&t.relatedStoryIds.length){r.relatedStoryIds=[];for(var n=0;n<t.relatedStoryIds.length;++n)r.relatedStoryIds[n]=t.relatedStoryIds[n]}return null!=t.description&&t.hasOwnProperty("description")&&(r.description=t.description),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s}(),i.Scrap=function(){function s(t){if(this.stories=[],this.childScraps=[],t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return s.prototype.id="",s.prototype.intendedDurationSec=0,s.prototype.synopsis="",s.prototype.prose="",s.prototype.stories=n.emptyArray,s.prototype.childScraps=n.emptyArray,s.create=function(t){return new s(t)},s.encode=function(t,e){if(e||(e=r.create()),null!=t.id&&Object.hasOwnProperty.call(t,"id")&&e.uint32(10).string(t.id),null!=t.intendedDurationSec&&Object.hasOwnProperty.call(t,"intendedDurationSec")&&e.uint32(16).uint32(t.intendedDurationSec),null!=t.synopsis&&Object.hasOwnProperty.call(t,"synopsis")&&e.uint32(26).string(t.synopsis),null!=t.prose&&Object.hasOwnProperty.call(t,"prose")&&e.uint32(34).string(t.prose),null!=t.stories&&t.stories.length)for(var n=0;n<t.stories.length;++n)e.uint32(66).string(t.stories[n]);if(null!=t.childScraps&&t.childScraps.length)for(n=0;n<t.childScraps.length;++n)e.uint32(74).string(t.childScraps[n]);return e},s.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},s.decode=function(t,r){t instanceof e||(t=e.create(t));for(var n=void 0===r?t.len:t.pos+r,s=new i.Scrap;t.pos<n;){var a=t.uint32();switch(a>>>3){case 1:s.id=t.string();break;case 2:s.intendedDurationSec=t.uint32();break;case 3:s.synopsis=t.string();break;case 4:s.prose=t.string();break;case 8:s.stories&&s.stories.length||(s.stories=[]),s.stories.push(t.string());break;case 9:s.childScraps&&s.childScraps.length||(s.childScraps=[]),s.childScraps.push(t.string());break;default:t.skipType(7&a)}}return s},s.decodeDelimited=function(t){return t instanceof e||(t=new e(t)),this.decode(t,t.uint32())},s.verify=function(t){if("object"!==typeof t||null===t)return"object expected";if(null!=t.id&&t.hasOwnProperty("id")&&!n.isString(t.id))return"id: string expected";if(null!=t.intendedDurationSec&&t.hasOwnProperty("intendedDurationSec")&&!n.isInteger(t.intendedDurationSec))return"intendedDurationSec: integer expected";if(null!=t.synopsis&&t.hasOwnProperty("synopsis")&&!n.isString(t.synopsis))return"synopsis: string expected";if(null!=t.prose&&t.hasOwnProperty("prose")&&!n.isString(t.prose))return"prose: string expected";if(null!=t.stories&&t.hasOwnProperty("stories")){if(!Array.isArray(t.stories))return"stories: array expected";for(var e=0;e<t.stories.length;++e)if(!n.isString(t.stories[e]))return"stories: string[] expected"}if(null!=t.childScraps&&t.hasOwnProperty("childScraps")){if(!Array.isArray(t.childScraps))return"childScraps: array expected";for(e=0;e<t.childScraps.length;++e)if(!n.isString(t.childScraps[e]))return"childScraps: string[] expected"}return null},s.fromObject=function(t){if(t instanceof i.Scrap)return t;var e=new i.Scrap;if(null!=t.id&&(e.id=String(t.id)),null!=t.intendedDurationSec&&(e.intendedDurationSec=t.intendedDurationSec>>>0),null!=t.synopsis&&(e.synopsis=String(t.synopsis)),null!=t.prose&&(e.prose=String(t.prose)),t.stories){if(!Array.isArray(t.stories))throw TypeError(".Scrap.stories: array expected");e.stories=[];for(var r=0;r<t.stories.length;++r)e.stories[r]=String(t.stories[r])}if(t.childScraps){if(!Array.isArray(t.childScraps))throw TypeError(".Scrap.childScraps: array expected");for(e.childScraps=[],r=0;r<t.childScraps.length;++r)e.childScraps[r]=String(t.childScraps[r])}return e},s.toObject=function(t,e){e||(e={});var r={};if((e.arrays||e.defaults)&&(r.stories=[],r.childScraps=[]),e.defaults&&(r.id="",r.intendedDurationSec=0,r.synopsis="",r.prose=""),null!=t.id&&t.hasOwnProperty("id")&&(r.id=t.id),null!=t.intendedDurationSec&&t.hasOwnProperty("intendedDurationSec")&&(r.intendedDurationSec=t.intendedDurationSec),null!=t.synopsis&&t.hasOwnProperty("synopsis")&&(r.synopsis=t.synopsis),null!=t.prose&&t.hasOwnProperty("prose")&&(r.prose=t.prose),t.stories&&t.stories.length){r.stories=[];for(var n=0;n<t.stories.length;++n)r.stories[n]=t.stories[n]}if(t.childScraps&&t.childScraps.length)for(r.childScraps=[],n=0;n<t.childScraps.length;++n)r.childScraps[n]=t.childScraps[n];return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s}(),i.WritingWorkspace=function(){function s(t){if(this.stories=[],this.scraps=[],t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return s.prototype.stories=n.emptyArray,s.prototype.scraps=n.emptyArray,s.create=function(t){return new s(t)},s.encode=function(t,e){if(e||(e=r.create()),null!=t.stories&&t.stories.length)for(var n=0;n<t.stories.length;++n)i.Story.encode(t.stories[n],e.uint32(10).fork()).ldelim();if(null!=t.scraps&&t.scraps.length)for(n=0;n<t.scraps.length;++n)i.Scrap.encode(t.scraps[n],e.uint32(18).fork()).ldelim();return e},s.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},s.decode=function(t,r){t instanceof e||(t=e.create(t));for(var n=void 0===r?t.len:t.pos+r,s=new i.WritingWorkspace;t.pos<n;){var a=t.uint32();switch(a>>>3){case 1:s.stories&&s.stories.length||(s.stories=[]),s.stories.push(i.Story.decode(t,t.uint32()));break;case 2:s.scraps&&s.scraps.length||(s.scraps=[]),s.scraps.push(i.Scrap.decode(t,t.uint32()));break;default:t.skipType(7&a)}}return s},s.decodeDelimited=function(t){return t instanceof e||(t=new e(t)),this.decode(t,t.uint32())},s.verify=function(t){if("object"!==typeof t||null===t)return"object expected";if(null!=t.stories&&t.hasOwnProperty("stories")){if(!Array.isArray(t.stories))return"stories: array expected";for(var e=0;e<t.stories.length;++e)if(r=i.Story.verify(t.stories[e]))return"stories."+r}if(null!=t.scraps&&t.hasOwnProperty("scraps")){if(!Array.isArray(t.scraps))return"scraps: array expected";for(e=0;e<t.scraps.length;++e){var r;if(r=i.Scrap.verify(t.scraps[e]))return"scraps."+r}}return null},s.fromObject=function(t){if(t instanceof i.WritingWorkspace)return t;var e=new i.WritingWorkspace;if(t.stories){if(!Array.isArray(t.stories))throw TypeError(".WritingWorkspace.stories: array expected");e.stories=[];for(var r=0;r<t.stories.length;++r){if("object"!==typeof t.stories[r])throw TypeError(".WritingWorkspace.stories: object expected");e.stories[r]=i.Story.fromObject(t.stories[r])}}if(t.scraps){if(!Array.isArray(t.scraps))throw TypeError(".WritingWorkspace.scraps: array expected");for(e.scraps=[],r=0;r<t.scraps.length;++r){if("object"!==typeof t.scraps[r])throw TypeError(".WritingWorkspace.scraps: object expected");e.scraps[r]=i.Scrap.fromObject(t.scraps[r])}}return e},s.toObject=function(t,e){e||(e={});var r={};if((e.arrays||e.defaults)&&(r.stories=[],r.scraps=[]),t.stories&&t.stories.length){r.stories=[];for(var n=0;n<t.stories.length;++n)r.stories[n]=i.Story.toObject(t.stories[n],e)}if(t.scraps&&t.scraps.length)for(r.scraps=[],n=0;n<t.scraps.length;++n)r.scraps[n]=i.Scrap.toObject(t.scraps[n],e);return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s}(),i})?n.apply(e,i):n)||(t.exports=s)},246:function(t,e,r){},247:function(t,e,r){},369:function(t,e,r){"use strict";r.r(e);var n=r(0),i=r.n(n),s=r(49),a=r.n(s),o=(r(246),r(247),r(37)),c=r(38),d=r(42),l=r(40),u=r(24),p=r(385),h=r(83),f=r(2),j=function(t){Object(d.a)(r,t);var e=Object(l.a)(r);function r(){return Object(o.a)(this,r),e.apply(this,arguments)}return Object(c.a)(r,[{key:"render",value:function(){return Object(f.jsxs)(p.a,{children:[Object(f.jsx)(u.b,{to:"/",children:Object(f.jsx)(p.a.Item,{header:!0,children:"Revision"})}),Object(f.jsx)(u.b,{to:"/data",children:Object(f.jsx)(p.a.Item,{children:Object(f.jsx)(h.a,{name:"save"})})})]})}}]),r}(n.Component),y=r(15),S=r(387),b=function(t){Object(d.a)(r,t);var e=Object(l.a)(r);function r(){return Object(o.a)(this,r),e.apply(this,arguments)}return Object(c.a)(r,[{key:"getCardUrl",value:function(){return"/story/"+this.props.story.id}},{key:"render",value:function(){return Object(f.jsx)(u.b,{to:this.getCardUrl(),children:Object(f.jsxs)(S.a,{style:{margin:"8px"},children:[Object(f.jsx)(S.a.Content,{header:this.props.story.name}),Object(f.jsx)(S.a.Content,{children:this.props.story.description.split("\n").map((function(t,e){return Object(f.jsx)("p",{children:t},e)}))})]})})}}]),r}(n.Component),O=r(390),g=r(391),v=r(389),x=r(148),m=r(99),w=r(14),k="story-ids";function C(t){return"story-".concat(t)}function I(){return D().map((function(t){return function(t){var e=localStorage.getItem(C(t));if(!e)throw Error("Unable to read story ".concat(t," from local storage"));return w.Story.create(JSON.parse(e))}(t)}))}function D(){var t=localStorage.getItem(k)||"[]";return JSON.parse(t)}function M(t){localStorage.setItem(k,JSON.stringify(t))}function P(t){localStorage.setItem(C(t.id),JSON.stringify(t))}function E(t){P(t);var e=D();e.push(t.id),M(e)}var W=function(){var t={storyMap:{}};return I().forEach((function(e){t.storyMap[e.id]=e.toJSON()})),t}(),A="storyList",N=Object(m.b)({name:A,initialState:W,reducers:{createStory:function(t,e){t.storyMap[e.payload.id]=e.payload},updateStory:function(t,e){t.storyMap[e.payload.id]=e.payload},removeStory:function(t,e){delete t.storyMap[e.payload]}}}),T=function(t){return function(t){return function(e){var r=t(e);return e.type.startsWith("storyList/")&&J(e),r}}},J=function(t){switch(t.type){case"".concat(A,"/createStory"):E(t.payload);break;case"".concat(A,"/updateStory"):P(t.payload);break;case"".concat(A,"/removeStory"):e=t.payload,M(D().filter((function(t){return t!==e}))),localStorage.removeItem(C(e))}var e},L=function(t){for(var e={},r=0,n=Object.entries(t.storyList.storyMap);r<n.length;r++){var i=Object(x.a)(n[r],2),s=i[0],a=i[1];e[s]=w.Story.fromObject(a)}return e},B=N.actions,F=B.createStory,U=B.updateStory,H=B.removeStory,G=N.reducer,z=r(116),R=function(){return Object(z.b)()},V=z.c,q=r(388),Y="scrap-ids";function $(t){return"scrap-".concat(t)}function _(){return K().map((function(t){return function(t){var e=localStorage.getItem($(t));if(!e)throw Error("Unable to read scrap ".concat(t," from local storage"));return w.Scrap.create(JSON.parse(e))}(t)}))}function K(){var t=localStorage.getItem(Y)||"[]";return JSON.parse(t)}function Q(t){localStorage.setItem(Y,JSON.stringify(t))}function X(t){localStorage.setItem($(t.id),JSON.stringify(t))}function Z(t){X(t);var e=K();e.push(t.id),Q(e)}var tt=function(){var t={scrapMap:{}};return _().forEach((function(e){t.scrapMap[e.id]=e.toJSON()})),t}(),et="scrapList",rt=Object(m.b)({name:et,initialState:tt,reducers:{createScrap:function(t,e){t.scrapMap[e.payload.id]=e.payload},updateScrap:function(t,e){t.scrapMap[e.payload.id]=e.payload},removeScrap:function(t,e){delete t.scrapMap[e.payload]}}}),nt=function(t){return function(t){return function(e){var r=t(e);return e.type.startsWith("scrapList/")&&it(e),r}}},it=function(t){switch(t.type){case"".concat(et,"/createScrap"):Z(t.payload);break;case"".concat(et,"/updateScrap"):X(t.payload);break;case"".concat(et,"/removeScrap"):e=t.payload,Q(K().filter((function(t){return t!==e}))),localStorage.removeItem($(e))}var e},st=function(t){for(var e={},r=0,n=Object.entries(t.scrapList.scrapMap);r<n.length;r++){var i=Object(x.a)(n[r],2),s=i[0],a=i[1];e[s]=w.Scrap.fromObject(a)}return e},at=rt.actions,ot=at.createScrap,ct=at.updateScrap,dt=(at.removeScrap,rt.reducer);function lt(t){var e=Object.values(t);return e.length?Object(f.jsx)(O.a,{style:{display:"flex",flexWrap:"wrap"},children:e.map((function(t,e){return Object(f.jsx)(b,{story:t},e)}))}):Object(f.jsx)(O.a,{children:"Whoops, no stories yet"})}function ut(){var t=V(L),e=R(),r=Object(y.f)();return Object(f.jsx)("div",{style:{margin:"24px"},children:Object(f.jsxs)(O.a.Group,{children:[Object(f.jsxs)(O.a,{style:{display:"flex"},children:[Object(f.jsxs)(g.a,{size:"medium",children:["Story List",Object(f.jsx)(g.a.Subheader,{children:"All your stories"})]}),Object(f.jsx)("div",{style:{flex:1,textAlign:"right"},children:Object(f.jsx)(v.a,{icon:!0,color:"green",onClick:function(){var t=w.Story.create({id:Object(q.a)(),name:"New Story",description:"A story about something"}).toJSON();e(F(t));var n,i=(n=t.id,w.Scrap.create({id:Object(q.a)(),synopsis:"Story Content",prose:"Here is where you can summarize the story, and start to structure / brainstorm\nFeel free to create new scraps for alternative starting points, or new supporting docs for this story.",stories:[n]}).toJSON());e(ot(i)),r.push("/story/".concat(t.id))},children:Object(f.jsx)(h.a,{name:"add"})})})]}),lt(t)]})})}var pt=r(13),ht=r(381),ft=r(386),jt=r(382),yt=r(384);function St(t){var e="",r=Math.floor(t/3600);t-=3600*r,e+=r.toString().padStart(2,"0")+":";var n=Math.floor(t/60);return t-=60*n,e+=n.toString().padStart(2,"0")+":",e+=Math.round(t).toString().padStart(2,"0")}function bt(t){if(!new RegExp("^[0-9:]+$").test(t))throw Error("Invalid duration string");var e=t.split(":").filter(Boolean);if(e.length>3)throw Error("Invalid duration string");for(var r=0,n=0;n<e.length;n++)r=60*r+parseInt(e[n],10);return r}var Ot=function(t){Object(d.a)(r,t);var e=Object(l.a)(r);function r(){var t;Object(o.a)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).state={durationErrorString:null,currentScrapFilter:"mine",currentScrapId:""},t}return Object(c.a)(r,[{key:"onNameChange",value:function(t){var e=this.props.story;e.name=t,this.props.onStoryChange(e)}},{key:"onDescriptionChange",value:function(t){var e=this.props.story;e.description=t,this.props.onStoryChange(e)}},{key:"getDurationString",value:function(){var t,e;return St((null===(t=this.props.story)||void 0===t||null===(e=t.duration)||void 0===e?void 0:e.seconds)||0)}},{key:"onDurationChange",value:function(t){var e;try{e=bt(t)}catch(n){return this.setDurationErrorString(!0)}var r=this.props.story;r.duration=w.Duration.create({seconds:e}),this.props.onStoryChange(r),this.setDurationErrorString(!1)}},{key:"setDurationErrorString",value:function(t){this.setState((function(e){return Object(pt.a)(Object(pt.a)({},e),{},{durationErrorString:t?"Please enter a duration of format HH:MM:SS":null})}))}},{key:"getFilteredScraps",value:function(t){var e=this;return this.props.scraps.filter((function(r){var n,i;return!("mine"===t&&r.stories.indexOf((null===(n=e.props.story)||void 0===n?void 0:n.id)||"")<0)&&!("others"===t&&r.stories.indexOf((null===(i=e.props.story)||void 0===i?void 0:i.id)||"")>=0)}))}},{key:"createNewScrap",value:function(){var t,e;return w.Scrap.create({id:Object(q.a)(),synopsis:"New Scrap",prose:'New scrap for "'+(null===(t=this.props.story)||void 0===t?void 0:t.name)+'" story\nFill this out with notes or prose content',stories:[null===(e=this.props.story)||void 0===e?void 0:e.id]})}},{key:"renderScrapDetails",value:function(){var t,e,r=this,n=this.props.scraps.find((function(t){return t.id===r.state.currentScrapId}));return n?(e=n.stories.indexOf((null===(t=this.props.story)||void 0===t?void 0:t.id)||"")>=0?Object(f.jsx)(v.a,{icon:!0,color:"red",onClick:function(){var t=n;t.stories=t.stories.filter((function(t){var e;return t!==(null===(e=r.props.story)||void 0===e?void 0:e.id)})),r.props.onScrapUpdate(t)},children:Object(f.jsx)(h.a,{name:"unlink"})}):Object(f.jsx)(v.a,{icon:!0,color:"green",onClick:function(){var t,e=n;e.stories.push((null===(t=r.props.story)||void 0===t?void 0:t.id)||""),r.props.onScrapUpdate(e)},children:Object(f.jsx)(h.a,{name:"linkify"})}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{style:{display:"flex"},children:[Object(f.jsx)(g.a,{children:n.synopsis}),Object(f.jsx)("div",{style:{flex:1,textAlign:"right"},children:e})]}),Object(f.jsx)(ht.a,{text:!0,children:n.prose.split("\n").map((function(t,e){return Object(f.jsx)("p",{children:t},"line-"+e)}))}),Object(f.jsx)("div",{style:{marginTop:"32px"},children:Object(f.jsx)(u.b,{to:"/scrap/".concat(n.id),children:Object(f.jsx)(v.a,{primary:!0,children:"Start writing"})})})]})):Object(f.jsx)(g.a,{children:"Please select a scrap"})}},{key:"render",value:function(){var t=this;return this.props.story?Object(f.jsxs)("div",{style:{margin:"24px"},children:[Object(f.jsxs)(O.a.Group,{children:[Object(f.jsxs)(O.a,{style:{display:"flex"},children:[Object(f.jsxs)(g.a,{children:["Story Details",Object(f.jsx)(g.a.Subheader,{children:"Set the title, top-level description here"})]}),Object(f.jsx)("div",{style:{flex:1,textAlign:"right"},children:Object(f.jsx)(v.a,{icon:!0,color:"red",onClick:function(){return t.props.onStoryDelete()},children:Object(f.jsx)(h.a,{name:"delete"})})})]}),Object(f.jsx)(O.a,{children:Object(f.jsxs)(ft.a,{children:[Object(f.jsxs)(ft.a.Group,{widths:"equal",children:[Object(f.jsx)(ft.a.Input,{label:"Story Name",defaultValue:this.props.story.name,onChange:function(e){return t.onNameChange(e.target.value)}}),Object(f.jsx)(ft.a.Input,{label:"Intended Duration (HH:MM:SS)",defaultValue:this.getDurationString(),error:this.state.durationErrorString,onChange:function(e){return t.onDurationChange(e.target.value)}})]}),Object(f.jsxs)(ft.a.Field,{children:[Object(f.jsx)("label",{children:"Story Description"}),Object(f.jsx)(jt.a,{defaultValue:this.props.story.description,onChange:function(e){return t.onDescriptionChange(e.target.value)},style:{fontFamily:"CourierPrime",height:"125px"}})]})]})})]}),Object(f.jsxs)(O.a.Group,{children:[Object(f.jsxs)(O.a,{style:{display:"flex"},children:[Object(f.jsxs)(g.a,{children:["Scraps",Object(f.jsx)(g.a.Subheader,{children:"These are the bits and pieces that make up the story"})]}),Object(f.jsx)("div",{style:{flex:1,textAlign:"right"},children:Object(f.jsx)(v.a,{icon:!0,color:"green",onClick:function(){t.props.onScrapCreate(t.createNewScrap())},children:Object(f.jsx)(h.a,{name:"add"})})})]}),Object(f.jsxs)(O.a,{style:{display:"flex"},children:[Object(f.jsxs)(p.a,{pointing:!0,vertical:!0,children:[Object(f.jsx)(p.a.Item,{children:Object(f.jsx)(yt.a,{fluid:!0,selection:!0,onChange:function(e,r){var n=r.value;t.setState(Object(pt.a)(Object(pt.a)({},t.state),{},{currentScrapFilter:n}))},defaultValue:this.state.currentScrapFilter,options:[{value:"all",text:"All stories",description:""+this.getFilteredScraps("all").length},{value:"mine",text:"This story",description:""+this.getFilteredScraps("mine").length},{value:"others",text:"Other stories",description:""+this.getFilteredScraps("others").length}]})}),this.getFilteredScraps(this.state.currentScrapFilter).map((function(e,r){return Object(f.jsx)(p.a.Item,{name:e.id,active:e.id===t.state.currentScrapId,onClick:function(){return t.setState(Object(pt.a)(Object(pt.a)({},t.state),{},{currentScrapId:e.id}))},children:e.synopsis},"scrap-menu-"+r)})).filter(Boolean)]}),Object(f.jsx)("div",{style:{flex:1,marginLeft:"32px"},children:this.renderScrapDetails()})]})]})]}):Object(f.jsx)("div",{children:"Whoops, could not find story"})}}]),r}(n.Component);function gt(t){var e,r,n=V((r=null===(e=t.match.params)||void 0===e?void 0:e.id,function(t){var e=t.storyList.storyMap[r];return e?w.Story.create(e):null})),i=Object.values(V(st)),s=R(),a=Object(y.f)();return Object(f.jsx)(Ot,{story:n,scraps:i,onStoryChange:function(t){return s(U(t.toJSON()))},onStoryDelete:function(){s(H(n.id)),a.push("/")},onScrapCreate:function(t){s(ot(t.toJSON())),a.push("/scrap/"+t.id)},onScrapUpdate:function(t){s(ct(t.toJSON()))}})}var vt=r(172),xt=r.n(vt),mt=r(224),wt=r(225),kt=r.n(wt);function Ct(){var t="writing_workspace_"+Date.now()+".write";kt()(function(){var t=w.WritingWorkspace.create({stories:I(),scraps:_()});return w.WritingWorkspace.encode(t).finish()}(),t)}function It(){return(It=Object(mt.a)(xt.a.mark((function t(e){var r;return xt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e[0].arrayBuffer();case 4:r=t.sent,Dt(new Uint8Array(r)),window.location.reload();case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Dt(t){var e=w.WritingWorkspace.decode(t);localStorage.clear(),e.stories.forEach((function(t){E(t)})),e.scraps.forEach((function(t){Z(t)}))}function Mt(){var t=V(L);return Object(f.jsx)("div",{style:{margin:"24px"},children:Object(f.jsxs)(O.a.Group,{children:[Object(f.jsx)(O.a,{style:{display:"flex"},children:Object(f.jsxs)(g.a,{size:"medium",children:["Data Management",Object(f.jsx)(g.a.Subheader,{children:"Load, Save, or Clear your Workspace"})]})}),Object(f.jsxs)(O.a,{children:[Object.keys(t).length," Stories"]}),Object(f.jsxs)(O.a,{children:[Object(f.jsx)(v.a,{color:"green",onClick:function(){Ct()},children:"Download Workspace"}),Object(f.jsx)(v.a,{color:"red",onClick:function(){localStorage.clear(),window.location.reload()},children:"Clear Workspace"})]}),Object(f.jsxs)(O.a,{children:[Object(f.jsx)(g.a,{size:"small",children:"Upload Workspace"}),Object(f.jsx)("input",{type:"file",accept:".write",onChange:function(t){return function(t){return It.apply(this,arguments)}(t.target.files)}})]})]})})}var Pt=r(107),Et=r(9),Wt=r.n(Et),At=r(226),Nt=r(44),Tt=r(128),Jt=r.n(Tt),Lt=(r(367),r(173)),Bt=r(383),Ft=r(174),Ut=r(227),Ht=r.n(Ut),Gt=1.0909,zt="scrapLink",Rt="isBlank";function Vt(t,e){return Object(pt.a)(Object(pt.a)({},t),e)}function qt(t,e,r){var n=[];return e[t]&&(n=e[t].stories),w.Scrap.create({id:r,synopsis:"New Scrap created in editor",prose:"this has placeholder content for now",stories:n})}var Yt=function(t){Object(d.a)(r,t);var e=Object(l.a)(r);function r(){return Object(o.a)(this,r),e.apply(this,arguments)}return Object(c.a)(r,[{key:"createScrap",value:function(){var t=qt(this.props.parentScrapId,this.props.scrapMap,this.props.scrapId);this.props.onScrapCreate(t)}},{key:"render",value:function(){var t=this,e=this.props.scrapMap[this.props.scrapId];return e?this.props.scrapId===this.props.parentScrapId?Object(f.jsx)("div",{style:{color:"red"},children:"Scraps shouldn't include themselves"}):Object(f.jsxs)("div",{style:{display:"flex"},children:[Object(f.jsx)(v.a,{icon:!0,color:"blue",onClick:function(){t.props.onGotoScrap()},children:Object(f.jsx)(h.a,{name:"angle right"})}),Object(f.jsxs)("div",{style:{marginLeft:"24px",flex:"1"},children:[Object(f.jsx)("div",{children:e.synopsis}),Object(f.jsx)("div",{children:St(e.intendedDurationSec)})]})]}):Object(f.jsxs)("div",{children:["Scrap does not exist yet.",Object(f.jsx)("button",{onClick:function(){t.createScrap()},children:"Create Now"})]})}}]),r}(n.Component);function $t(t){if(!t)return t;var e={};return t.getText().trim().length||(e.isBlank=!0),t.set("data",Wt.a.fromJS(e))}function _t(t,e,r,n,i){if(!t)return{processProgress:n,contentBlock:t};var s=t.getData().toJS(),a=t.getText().trim(),o=!e||e.getData().get(Rt),c=!r||r.getData().get(Rt);if(s.isBlank)o||(n.currentDurationSec+=Gt);else if(function(t,e,r){return t&&e&&(/^(int|ext|est|i\/e)[\s.]/i.test(r)||r.startsWith("."))}(o,c,a))s=Vt(s,{isFountainHeader:!0}),n.currentDurationSec+=Gt;else if(function(t,e,r){return t&&e&&(r.startsWith(">")&&!r.endsWith("<")||r.toUpperCase()===r&&r.endsWith("TO:"))}(o,c,a))s=Vt(s,{isFountainTransition:!0}),n.currentDurationSec+=Gt;else if(function(t){return t.startsWith(">")&&t.endsWith("<")}(a))s=Vt(s,{isFountainCentered:!0}),n.currentDurationSec+=Gt;else if(function(t){return t.startsWith("{{")&&t.endsWith("}}")}(a)){var d=(s=Vt(s,function(t){return{scrapLink:t.replace("{{","").replace("}}","").trim(),isScrapEmbedding:!0}}(a))).scrapLink;if(i[d]){n.childScraps=n.childScraps.add(d);var l=i[d];n.currentDurationSec+=l.intendedDurationSec}}var u=t.set("data",Wt.a.fromJS(s));var p=u.getCharacterList().map((function(t,e){return t}));return{contentBlock:u.set("characterList",p),processProgress:n}}var Kt=new Nt.CompositeDecorator([{strategy:function(t,e,r){t.getData().get("isScrapEmbedding")&&e(0,t.getText().length)},component:function(t){var e=t.contentState.getBlockMap().get(t.blockKey).getData().get(zt),r=V(st),n=R(),i=Object(y.f)(),s=Object(y.g)(),a=s.pathname.replace("/scrap/","");return Object(f.jsxs)("div",{style:{background:"grey",fontWeight:"bold",display:"flex",padding:"8px"},children:[Object(f.jsx)("div",{style:{margin:"auto 24px auto 0",color:"white"},children:t.children}),Object(f.jsx)("div",{style:{flex:"1",cursor:"pointer",padding:"8px",border:"1px solid",background:"white",fontWeight:"normal"},children:Object(f.jsx)(Yt,{parentScrapId:a,scrapId:e,scrapMap:r,onScrapCreate:function(t){return n(ot(t.toJSON()))},onGotoScrap:function(){i.push("/scrap/".concat(e))}})})]})}},{strategy:function(t,e,r){t.getData().get("isFountainHeader")&&e(0,t.getText().length)},component:function(t){return Object(f.jsx)("div",{style:{fontWeight:"bold"},children:t.children})}},{strategy:function(t,e,r){t.getData().get("isFountainTransition")&&e(0,t.getText().length)},component:function(t){return Object(f.jsx)("div",{style:{fontWeight:"bold",textAlign:"right"},children:t.children})}},{strategy:function(t,e,r){t.getData().get("isFountainCentered")&&e(0,t.getText().length)},component:function(t){return Object(f.jsx)("div",{style:{fontWeight:"bold",textAlign:"center"},children:t.children})}}]),Qt={GREEN:{color:"green"}},Xt=function(t){Object(d.a)(r,t);var e=Object(l.a)(r);function r(t){var n;return Object(o.a)(this,r),(n=e.call(this,t)).domEditor=void 0,n.remapEditorContent=Ht()((function(){var t=n.state.editorState.getCurrentContent().getPlainText();if(t!=n.state.lastEmittedStr){n.persistProse(t);for(var e={processStartEpoch:Date.now(),currentDurationSec:0,childScraps:Et.OrderedSet()},r=n.state.editorState.getCurrentContent(),i=r.getBlockMap(),s=Object(Pt.a)(i.keys()),a=0;a<s.length;a++){var o=s[a];i=i.set(o,$t(i.get(o)))}for(var c=0;c<s.length;c++){var d=c>0?i.get(s[c-1]):null,l=s[c],u=c+1<s.length?i.get(s[c+1]):null,p=_t(i.get(l),d,u,e,n.props.scrapMap);e=p.processProgress,i=i.set(l,p.contentBlock)}var h=r.set("blockMap",i),f=Date.now()-e.processStartEpoch;console.log("Update took: "+f);var j=n.props.scrapMap[n.props.scrapId];if(!function(t,e){if(t.size!==e.length)return!1;for(var r=0;r<e.length;r++)if(!t.includes(e[r]))return!1;return!0}(e.childScraps,j.childScraps)){var y=w.Scrap.create(Object(pt.a)(Object(pt.a)({},j),{},{childScraps:Object(Pt.a)(e.childScraps.toArray())}));n.props.onScrapUpdate(y)}n.setState({editorState:Nt.EditorState.set(n.state.editorState,{currentContent:h}),lastEmittedStr:t,actualDurationSec:e.currentDurationSec})}}),200),n.state=n.initializeState(t),n.remapEditorContent(),n}return Object(c.a)(r,[{key:"initializeState",value:function(t){return{editorState:this.buildInitialEditorState(t),lastEmittedStr:"",scrapId:t.scrapId,durationErrorString:null,actualDurationSec:0,parentScrapIds:this.buildParentScrapIds(t)}}},{key:"buildInitialEditorState",value:function(t){var e=t.scrapMap[t.scrapId];return e?Nt.EditorState.createWithContent(Nt.ContentState.createFromText(e.prose),Kt):Nt.EditorState.createEmpty()}},{key:"componentDidUpdate",value:function(t,e,r){this.state.scrapId!=this.props.scrapId&&(this.setState(this.initializeState(this.props)),this.remapEditorContent())}},{key:"buildParentScrapIds",value:function(t){var e=t.scrapMap[this.props.scrapId],r=[];for(var n in t.scrapMap){var i=t.scrapMap[n];i.childScraps.includes(e.id)&&r.push(i.id)}return r}},{key:"getBreadcrumbs",value:function(t){var e,r=this,n=t.stories.map((function(t){return r.props.storyMap[t]})).filter(Boolean),i=n.map((function(t){return Object(f.jsx)(Lt.a,{link:!0,children:Object(f.jsx)(u.b,{to:"/story/"+t.id,children:t.name})})}));e=n.length?Object(f.jsxs)("div",{children:["Stories:",Object(f.jsx)(Bt.a,{children:i.reduce((function(t,e){return[t,Object(f.jsx)(Ft.a,{icon:"right chevron"}),e]}))})]}):Object(f.jsx)("div",{children:"No parent stories"});var s,a=this.state.parentScrapIds.map((function(t){return r.props.scrapMap[t]})).filter(Boolean),o=a.map((function(t){return Object(f.jsx)(Lt.a,{link:!0,children:Object(f.jsx)(u.b,{to:"/scrap/"+t.id,children:t.synopsis})})}));return s=a.length?Object(f.jsxs)("div",{children:["Scraps:",Object(f.jsx)(Bt.a,{children:o.reduce((function(t,e){return[t,Object(f.jsx)(Ft.a,{icon:"right chevron"}),e]}))})]}):Object(f.jsx)("div",{children:"No parent scraps"}),Object(f.jsxs)("div",{children:[e,s]})}},{key:"onSynopsisChange",value:function(t){var e=this.props.scrapMap[this.props.scrapId];e.synopsis=t,this.props.onScrapUpdate(e)}},{key:"getPrimaryForm",value:function(t){var e=this;return Object(f.jsx)(O.a,{children:Object(f.jsx)(ft.a,{children:Object(f.jsxs)(ft.a.Group,{widths:"equal",children:[Object(f.jsx)(ft.a.Input,{label:"Synopsis",defaultValue:t.synopsis,onChange:function(t){return e.onSynopsisChange(t.target.value)}}),Object(f.jsx)(ft.a.Input,{label:"Intended Duration (HH:MM:SS)",defaultValue:St(t.intendedDurationSec),error:this.state.durationErrorString,onChange:function(t){return e.onDurationChange(t.target.value)}})]})})})}},{key:"onDurationChange",value:function(t){var e;try{e=bt(t)}catch(n){return this.setDurationErrorString(!0)}var r=this.props.scrapMap[this.props.scrapId];r.intendedDurationSec=e,this.props.onScrapUpdate(r),this.setDurationErrorString(!1)}},{key:"setDurationErrorString",value:function(t){this.setState({durationErrorString:t?"Please enter a duration of format HH:MM:SS":null})}},{key:"getProseEditor",value:function(){var t=this;return Object(f.jsx)("div",{onClick:function(){t.focus()},style:{border:"1px solid",padding:"0",minHeight:"300px",maxHeight:"500px",overflowY:"scroll",fontFamily:"CourierPrime, Courier, monospace"},children:Object(f.jsx)(Nt.Editor,{customStyleMap:Qt,stripPastedStyles:!0,onCut:function(e,r){t.onCut(e,r,!0)},onCopy:function(e,r){t.onCut(e,r,!1)},editorState:this.state.editorState,ref:function(e){t.setDomEditorRef(e)},onChange:function(e){t.onProseChange(e)}})})}},{key:"setDomEditorRef",value:function(t){this.domEditor=t}},{key:"focus",value:function(){this.domEditor.focus()}},{key:"onProseChange",value:function(t){this.setState({editorState:t}),this.remapEditorContent()}},{key:"onCut",value:function(t,e,r){var n=this;e.preventDefault();var i=this.state.editorState,s=Jt()(i),a=s?s.map((function(t){return t.getText()})).join("\n"):"";At.a(a).then((function(){if(r){var t=Nt.Modifier.replaceText(i.getCurrentContent(),i.getSelection(),"");n.setState({editorState:Nt.EditorState.set(i,{currentContent:t})})}}))}},{key:"persistProse",value:function(t){var e=this.props.scrapMap[this.props.scrapId];e.prose=t,this.props.onScrapUpdate(e)}},{key:"addChildScrap",value:function(){var t=this.state.editorState,e=t.getSelection(),r=Object(q.a)(),n=qt(this.props.scrapId,this.props.scrapMap,r);this.props.onScrapCreate(n);var i="\n{{"+r+"}}\n",s=e.isCollapsed()?Nt.Modifier.insertText(t.getCurrentContent(),e,i):Nt.Modifier.replaceText(t.getCurrentContent(),e,i);this.setState({editorState:Nt.EditorState.set(t,{currentContent:s})}),this.remapEditorContent()}},{key:"render",value:function(){var t=this,e=this.props.scrapMap[this.props.scrapId];return e?Object(f.jsxs)("div",{style:{margin:"24px"},children:[this.getBreadcrumbs(e),this.getPrimaryForm(e),Object(f.jsxs)("div",{children:[Object(f.jsxs)("span",{children:["Actual duration: ",St(this.state.actualDurationSec)]}),Object(f.jsx)("button",{onClick:function(){return t.addChildScrap()},children:"Add child scrap"})]}),this.getProseEditor()]},"scrap-details-"+this.props.scrapId):Object(f.jsx)("div",{children:"Whoops, could not find scrap"})}}]),r}(n.Component);function Zt(t){var e=V(L),r=V(st),n=R();return Object(f.jsx)(Xt,{scrapId:t.match.params.id,scrapMap:r,storyMap:e,onScrapCreate:function(t){return n(ot(t.toJSON()))},onScrapUpdate:function(t){return n(ct(t.toJSON()))}})}var te=function(t){Object(d.a)(r,t);var e=Object(l.a)(r);function r(){var t;Object(o.a)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).state={showListInput:!0,showCurrentScores:!1,nextCandidateLabel:"",nextCandidateDesc:"",candidates:[],winMatrix:[],candidateIndexA:-1,candidateIndexB:-1},t}return Object(c.a)(r,[{key:"addCandidate",value:function(){for(var t=[].concat(Object(Pt.a)(this.state.candidates),[{label:this.state.nextCandidateLabel,description:this.state.nextCandidateDesc,currentScore:1,wins:0,losses:0}]),e=1/(10*t.length),r=Object(Pt.a)(Array(t.length)).map((function(r){return Array(t.length).fill(e)})),n=0;n<r.length;n++)r[n][n]=0;this.setState(Object(pt.a)(Object(pt.a)({},this.state),{},{candidates:t,winMatrix:r,nextCandidateLabel:"",nextCandidateDesc:""}))}},{key:"setupNewComparison",value:function(){var t=this,e=this.state.candidates.map((function(e,r){return 1/t.getTotalComparisons(r)})),r=this.randomSelectWeighted(e),n=e.map((function(e,n){return n===r?0:1/(t.state.winMatrix[n][r]+t.state.winMatrix[r][n])})),i=this.randomSelectWeighted(n);this.setState(Object(pt.a)(Object(pt.a)({},this.state),{},{showListInput:!1,candidateIndexA:r,candidateIndexB:i}))}},{key:"randomSelectWeighted",value:function(t){for(var e=t.reduce((function(t,e){return t+e})),r=Math.random()*e,n=0,i=0;i<t.length;i++)if((n+=t[i])>=r)return i;throw Error("should not get here")}},{key:"getTotalComparisons",value:function(t){for(var e=0,r=0;r<this.state.winMatrix.length;r++)e+=this.state.winMatrix[t][r]+this.state.winMatrix[r][t];return e}},{key:"renderComparison",value:function(){var t=this;if(this.state.candidateIndexA<0||this.state.candidateIndexB<0)return Object(f.jsx)("div",{children:"no comparison yet"});var e=this.state.candidates[this.state.candidateIndexA],r=this.state.candidates[this.state.candidateIndexB];return Object(f.jsxs)("div",{style:{marginTop:"100px",marginBottom:"100px"},children:[Object(f.jsx)("h2",{children:"Comparison"}),Object(f.jsxs)("div",{style:{display:"flex"},children:[Object(f.jsxs)("div",{style:{flex:1},children:[Object(f.jsxs)("h3",{children:[e.label,Object(f.jsx)("button",{onClick:function(){return t.updateWin(t.state.candidateIndexA,t.state.candidateIndexB)},children:"Select"})]}),e.description.split("\n").map((function(t){return Object(f.jsx)("p",{children:t})}))]}),Object(f.jsxs)("div",{style:{flex:1},children:[Object(f.jsxs)("h3",{children:[r.label,Object(f.jsx)("button",{onClick:function(){return t.updateWin(t.state.candidateIndexB,t.state.candidateIndexA)},children:"Select"})]}),r.description.split("\n").map((function(t){return Object(f.jsx)("p",{children:t})}))]})]})]})}},{key:"updateWin",value:function(t,e){var r=this,n=this.state.winMatrix;n[t][e]+=1;var i=this.state.candidates;i[t].wins+=1,i[e].losses+=1;for(var s=0;s<1e3;s++){for(var a=0;a<i.length;a++){for(var o=0,c=0;c<i.length;c++)o+=n[a][c];for(var d=0,l=0;l<i.length;l++){if(a!==l)d+=(n[a][l]+n[l][a])/(i[a].currentScore+i[l].currentScore)}i[a].currentScore=o/d}for(var u=0,p=0;p<i.length;p++)u+=i[p].currentScore;u/=i.length;for(var h=0;h<i.length;h++)i[h].currentScore/=u}this.setState(Object(pt.a)(Object(pt.a)({},this.state),{},{candidates:i,winMatrix:n}),(function(){r.setupNewComparison()}))}},{key:"renderWinMatrix",value:function(){return this.state.showCurrentScores?Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Current Win Matrix"}),Object(f.jsx)("pre",{children:this.state.winMatrix.map((function(t){return t.join(",\t")+"\n"}))})]}):Object(f.jsx)("div",{})}},{key:"renderCandidates",value:function(){if(!this.state.showCurrentScores&&!this.state.showListInput)return Object(f.jsx)("div",{});var t=this.state.candidates.map((function(t){return t})).sort((function(t,e){return e.currentScore-t.currentScore}));return Object(f.jsxs)("div",{children:[Object(f.jsxs)("h2",{children:[t.length," Candidates"]}),t.map((function(t,e){return Object(f.jsx)("div",{children:Object(f.jsxs)("h3",{children:[t.label," (",t.currentScore,", ",t.wins," wins, ",t.losses," losses)"]})})}))]})}},{key:"toggleShowCurrentScores",value:function(){this.setState(Object(pt.a)(Object(pt.a)({},this.state),{},{showCurrentScores:!this.state.showCurrentScores}))}},{key:"updateNextCandidateLabel",value:function(t){this.setState(Object(pt.a)(Object(pt.a)({},this.state),{},{nextCandidateLabel:t}))}},{key:"updateNextCandidateDesc",value:function(t){this.setState(Object(pt.a)(Object(pt.a)({},this.state),{},{nextCandidateDesc:t}))}},{key:"render",value:function(){var t,e=this;return t=this.state.showListInput?Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Declare Candidates"}),Object(f.jsx)("p",{children:"Let's create some candidates"}),Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{type:"text",value:this.state.nextCandidateLabel,onChange:function(t){return e.updateNextCandidateLabel(t.target.value)}}),Object(f.jsx)("textarea",{value:this.state.nextCandidateDesc,onChange:function(t){return e.updateNextCandidateDesc(t.target.value)}})]}),Object(f.jsx)("button",{style:{display:"block"},onClick:function(){return e.addCandidate()},children:"Add Candidate"}),Object(f.jsx)("button",{style:{display:"block"},onClick:function(){return e.setupNewComparison()},children:"Parse and begin"}),this.renderCandidates()]}):Object(f.jsxs)("div",{children:[this.renderComparison(),Object(f.jsx)("button",{style:{display:"block"},onClick:function(){return e.toggleShowCurrentScores()},children:"Toggle results"}),this.renderWinMatrix(),this.renderCandidates()]}),Object(f.jsxs)("div",{style:{margin:"24px"},children:[Object(f.jsx)("h1",{children:"Decisions"}),Object(f.jsx)("p",{children:"Let's make some decisions based on pairwise comparisons. You know that FaceMash scene in Social Network? It's just like that, except hopefully you're using it for better decisions."}),t]})}}]),r}(n.Component);var ee=function(){return Object(f.jsxs)(u.a,{children:[Object(f.jsx)(j,{}),Object(f.jsxs)(y.c,{children:[Object(f.jsx)(y.a,{path:"/decisions",component:te}),Object(f.jsx)(y.a,{path:"/data",component:Mt}),Object(f.jsx)(y.a,{path:"/story/:id",component:gt}),Object(f.jsx)(y.a,{path:"/scrap/:id",component:Zt}),Object(f.jsx)(y.a,{path:"/",component:ut})]})]})},re=Object(m.a)({reducer:{storyList:G,scrapList:dt},middleware:function(t){return t().concat([T,nt])}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r(368);a.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(z.a,{store:re,children:Object(f.jsx)(ee,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[369,1,2]]]);
//# sourceMappingURL=main.76bc6855.chunk.js.map